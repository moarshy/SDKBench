{
  "score": 0.0,
  "tests_passed": 1,
  "tests_failed": 2,
  "tests_total": 3,
  "tests_skipped": 0,
  "duration": 1.8101282119750977,
  "error": "2 tests failed",
  "failed_tests": [
    "test_table_creation",
    "test_data_stored"
  ],
  "failure_details": [
    {
      "test_name": "test_table_creation",
      "file_path": "tests/test_data_ops.py",
      "line_number": 21,
      "error_message": "RuntimeError: lance erro...",
      "stack_trace": "tests/test_data_ops.py:21: in test_table_creation\n    data_ops.main()\nexpected/data_ops.py:161: in main\n    table3.add(complex_data)\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:2352: in add\n    return LOOP.run(\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/background_loop.py:25: in run\n    return asyncio.run_coroutine_threadsafe(future, self.loop).result()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:456: in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:3536: in add\n    return await self._inner.add(data, mode or \"append\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   RuntimeError: lance error: LanceError(Arrow): Arrow error: C Data interface error: Invalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023839983. Detail: Python exception: Traceback (most recent call last):\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py\", line 303, in gen\nE       yield pa.Table.from_batches([batch]).cast(reordered_schema).to_batches()[0]\nE             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/table.pxi\", line 4683, in pyarrow.lib.Table.cast\nE     File \"pyarrow/table.pxi\", line 593, in pyarrow.lib.ChunkedArray.cast\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/pyarrow/compute.py\", line 405, in cast\nE       return call_function(\"cast\", [arr], options, memory_pool)\nE              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/_compute.pyx\", line 598, in pyarrow._compute.call_function\nE     File \"pyarrow/_compute.pyx\", line 393, in pyarrow._compute.Function.call\nE     File \"pyarrow/error.pxi\", line 155, in pyarrow.lib.pyarrow_internal_check_status\nE     File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\nE   pyarrow.lib.ArrowInvalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023839983\nE   , /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-datafusion-0.39.0/src/utils.rs:51:31\n----------------------------- Captured stdout call -----------------------------\nConnected to LanceDB\n\n=== Example 1: get_or_create_table ===\nTable 'my_vectors' exists, opening...\nAdded 2 records\n\nTable 'my_vectors' exists, opening...\nTable has 6 rows\n\n=== Example 2: ensure_table (overwrite mode) ===\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable still has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable now has 1 rows (overwritten)\n\n=== Example 3: Complex schema with metadata ===\nTable 'complex_vectors' exists, opening..."
    },
    {
      "test_name": "test_data_stored",
      "file_path": "tests/test_data_ops.py",
      "line_number": 28,
      "error_message": "RuntimeError: lance error: ...",
      "stack_trace": "tests/test_data_ops.py:28: in test_data_stored\n    data_ops.main()\nexpected/data_ops.py:161: in main\n    table3.add(complex_data)\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:2352: in add\n    return LOOP.run(\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/background_loop.py:25: in run\n    return asyncio.run_coroutine_threadsafe(future, self.loop).result()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:456: in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:3536: in add\n    return await self._inner.add(data, mode or \"append\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   RuntimeError: lance error: LanceError(Arrow): Arrow error: C Data interface error: Invalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023902156. Detail: Python exception: Traceback (most recent call last):\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py\", line 303, in gen\nE       yield pa.Table.from_batches([batch]).cast(reordered_schema).to_batches()[0]\nE             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/table.pxi\", line 4683, in pyarrow.lib.Table.cast\nE     File \"pyarrow/table.pxi\", line 593, in pyarrow.lib.ChunkedArray.cast\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/pyarrow/compute.py\", line 405, in cast\nE       return call_function(\"cast\", [arr], options, memory_pool)\nE              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/_compute.pyx\", line 598, in pyarrow._compute.call_function\nE     File \"pyarrow/_compute.pyx\", line 393, in pyarrow._compute.Function.call\nE     File \"pyarrow/error.pxi\", line 155, in pyarrow.lib.pyarrow_internal_check_status\nE     File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\nE   pyarrow.lib.ArrowInvalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023902156\nE   , /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-datafusion-0.39.0/src/utils.rs:51:31\n----------------------------- Captured stdout call -----------------------------\nConnected to LanceDB\n\n=== Example 1: get_or_create_table ===\nTable 'my_vectors' exists, opening...\nAdded 2 records\n\nTable 'my_vectors' exists, opening...\nTable has 8 rows\n\n=== Example 2: ensure_table (overwrite mode) ===\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable still has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable now has 1 rows (overwritten)\n\n=== Example 3: Complex schema with metadata ===\nTable 'complex_vectors' exists, opening..."
    }
  ],
  "raw_output": "============================= test session starts ==============================\nplatform darwin -- Python 3.12.0, pytest-9.0.1, pluggy-1.6.0 -- /Users/arshath/miniforge3/bin/python\ncachedir: .pytest_cache\nrootdir: /private/var/folders/wx/bj4n9pyj10n74txq4mpt0j9h0000gn/T/fcorr_7a9gjbtd\nplugins: anyio-4.7.0\ncollecting ... collected 3 items\n\ntests/test_data_ops.py::test_database_connection PASSED                  [ 33%]\ntests/test_data_ops.py::test_table_creation FAILED                       [ 66%]\ntests/test_data_ops.py::test_data_stored FAILED                          [100%]\n\n=================================== FAILURES ===================================\n_____________________________ test_table_creation ______________________________\ntests/test_data_ops.py:21: in test_table_creation\n    data_ops.main()\nexpected/data_ops.py:161: in main\n    table3.add(complex_data)\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:2352: in add\n    return LOOP.run(\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/background_loop.py:25: in run\n    return asyncio.run_coroutine_threadsafe(future, self.loop).result()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:456: in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:3536: in add\n    return await self._inner.add(data, mode or \"append\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   RuntimeError: lance error: LanceError(Arrow): Arrow error: C Data interface error: Invalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023839983. Detail: Python exception: Traceback (most recent call last):\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py\", line 303, in gen\nE       yield pa.Table.from_batches([batch]).cast(reordered_schema).to_batches()[0]\nE             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/table.pxi\", line 4683, in pyarrow.lib.Table.cast\nE     File \"pyarrow/table.pxi\", line 593, in pyarrow.lib.ChunkedArray.cast\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/pyarrow/compute.py\", line 405, in cast\nE       return call_function(\"cast\", [arr], options, memory_pool)\nE              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/_compute.pyx\", line 598, in pyarrow._compute.call_function\nE     File \"pyarrow/_compute.pyx\", line 393, in pyarrow._compute.Function.call\nE     File \"pyarrow/error.pxi\", line 155, in pyarrow.lib.pyarrow_internal_check_status\nE     File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\nE   pyarrow.lib.ArrowInvalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023839983\nE   , /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-datafusion-0.39.0/src/utils.rs:51:31\n----------------------------- Captured stdout call -----------------------------\nConnected to LanceDB\n\n=== Example 1: get_or_create_table ===\nTable 'my_vectors' exists, opening...\nAdded 2 records\n\nTable 'my_vectors' exists, opening...\nTable has 6 rows\n\n=== Example 2: ensure_table (overwrite mode) ===\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable still has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable now has 1 rows (overwritten)\n\n=== Example 3: Complex schema with metadata ===\nTable 'complex_vectors' exists, opening...\n_______________________________ test_data_stored _______________________________\ntests/test_data_ops.py:28: in test_data_stored\n    data_ops.main()\nexpected/data_ops.py:161: in main\n    table3.add(complex_data)\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:2352: in add\n    return LOOP.run(\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/background_loop.py:25: in run\n    return asyncio.run_coroutine_threadsafe(future, self.loop).result()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:456: in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n/Users/arshath/miniforge3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py:3536: in add\n    return await self._inner.add(data, mode or \"append\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   RuntimeError: lance error: LanceError(Arrow): Arrow error: C Data interface error: Invalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023902156. Detail: Python exception: Traceback (most recent call last):\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/lancedb/table.py\", line 303, in gen\nE       yield pa.Table.from_batches([batch]).cast(reordered_schema).to_batches()[0]\nE             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/table.pxi\", line 4683, in pyarrow.lib.Table.cast\nE     File \"pyarrow/table.pxi\", line 593, in pyarrow.lib.ChunkedArray.cast\nE     File \"/Users/arshath/miniforge3/lib/python3.12/site-packages/pyarrow/compute.py\", line 405, in cast\nE       return call_function(\"cast\", [arr], options, memory_pool)\nE              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     File \"pyarrow/_compute.pyx\", line 598, in pyarrow._compute.call_function\nE     File \"pyarrow/_compute.pyx\", line 393, in pyarrow._compute.Function.call\nE     File \"pyarrow/error.pxi\", line 155, in pyarrow.lib.pyarrow_internal_check_status\nE     File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\nE   pyarrow.lib.ArrowInvalid: Casting from timestamp[us] to timestamp[ms] would lose data: 1764161023902156\nE   , /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-datafusion-0.39.0/src/utils.rs:51:31\n----------------------------- Captured stdout call -----------------------------\nConnected to LanceDB\n\n=== Example 1: get_or_create_table ===\nTable 'my_vectors' exists, opening...\nAdded 2 records\n\nTable 'my_vectors' exists, opening...\nTable has 8 rows\n\n=== Example 2: ensure_table (overwrite mode) ===\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable still has 3 rows\nEnsuring table 'idempotent_table' with overwrite mode...\nTable 'idempotent_table' created/overwritten successfully\nTable now has 1 rows (overwritten)\n\n=== Example 3: Complex schema with metadata ===\nTable 'complex_vectors' exists, opening...\n=========================== short test summary info ============================\nFAILED tests/test_data_ops.py::test_table_creation - RuntimeError: lance erro...\nFAILED tests/test_data_ops.py::test_data_stored - RuntimeError: lance error: ...\n========================= 2 failed, 1 passed in 1.02s ==========================\n"
}